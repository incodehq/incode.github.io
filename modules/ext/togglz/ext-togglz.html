<!doctype html>
<html>
 <head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <!-- No caching headers --> 
  <meta http-equiv="cache-control" content="no-cache"> 
  <meta http-equiv="pragma" content="no-cache"> 
  <meta http-equiv="expires" content="-1"> 
  <title>Togglz Extension</title> 
  <link rel="icon" type="image/png" href="../../../images/incode-favicon.png"> 
  <!--
        Based on DataNucleus' template,
        that was in turn based on an earlier version of Apache Isis' template,
        that was in turn based on Apache Deltaspike's template.

        This template uses
        * Bootstrap v3.3.7 (https://getbootstrap.com/) for navbar.
        * Bootstrap TOC plugin v0.4.1 (https://afeld.github.io/bootstrap-toc/)
          for the table of contents.
        * jQuery (necessary for Bootstrap's JavaScript plugins)
        * Font-Awesome for some icons used by Asciidoctor

        Also:
        * Bootswatch "flatly" theme for Bootstrap (https://bootswatch.com/flatly).
        * slick.js (carousel)
        * add a link to all headers (home-grown, adapted from blog posts)
        * integration of elasticlunr.js (home-grown, adapted from blog posts)
    --> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"> 
  <link href="../../../css/bootstrap-toc/0.4.1/bootstrap-toc.min.css" rel="stylesheet"> 
  <link href="../../../css/asciidoctor/foundation.css" rel="stylesheet"> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"> 
  <link href="../../../css/slick/1.5.0/slick.css" rel="stylesheet"> 
  <link href="../../../css/slick/1.5.0/slick-theme.css" rel="stylesheet"> 
  <link href="../../../css/search-panel/search-panel.css" rel="stylesheet"> 
  <link href="../../../css/header-links/header-links.css" rel="stylesheet"> 
  <link href="../../../css/sticky-header/sticky-header.css" rel="stylesheet"> 
  <link href="../../../css/customisations.css" rel="stylesheet"> 
  <!-- Coderay syntax formatter --> 
  <style type="text/css">
        /* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
    </style> 
 </head> 
 <body data-spy="scroll" data-target="#toc"> 
  <div id="basedir" style="display:none;">
   ../../../
  </div> 
  <div id="docname" style="display:none;">
   ext-togglz
  </div> 
  <div id="filetype" style="display:none;">
   html
  </div> 
  <!-- Navbar --> 
  <nav class="navbar navbar-default navbar-static-top header"> 
   <div class="container"> 
    <div class="navbar-header"> 
     <!-- Three line menu button for use on mobile screens --> 
     <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
     <a class="navbar-brand" href="../../../index.html"> <img alt="Brand" src="../../../images/incode-logo-66x52.png"> </a> 
     <a class="navbar-brand" href="../../../index.html">Incode Platform</a> 
    </div> 
    <!-- Navbar that will collapse on mobile screens --> 
    <div id="navbar" class="navbar-collapse collapse"> 
     <ul class="nav navbar-nav"> 
      <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Quickstart<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="../../../quickstart/quickstart.html">Quickstart App</a></li> 
       </ul> </li> 
      <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Modules<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="../../../modules/incode-parent.html">Parent POM</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Modules</li> 
        <li><a href="../../../modules/lib/lib.html">Libraries</a></li> 
        <li><a href="../../../modules/spi/spi.html">SPI Implementations</a></li> 
        <li><a href="../../../modules/wkt/wkt.html">Wicket Components</a></li> 
        <li><a href="../../../modules/mml/mml.html">MetaModel Facets</a></li> 
        <li><a href="../../../modules/ext/ext.html">Extensions</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Examples</li> 
        <li><a href="../../../modules/dom/dom.html">Example Subdomains</a></li> 
       </ul> </li> 
      <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Support<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li class="dropdown-header">Source code</li> 
        <li><a href="https://github.com/incodehq/incode-platform">Github</a></li> 
        <li><a href="https://github.com/incodehq/incode-platform/issues">Issue Tracker</a></li> 
        <li><a href="../../../pages/change-log/change-log.html">Change Log</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Guides</li> 
        <li><a href="../../../pages/contributors-guide/contributors-guide.html">Contributors guide</a></li> 
        <li><a href="../../../pages/committers-guide/committers-guide.html">Committers guide</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="../../../pages/license.html">License</a></li> 
        <li><a href="../../../pages/thanks.html">Thanks</a></li> 
       </ul> </li> 
     </ul> 
     <div class="nav navbar-nav navbar-right"> 
      <!-- 'style' added to fix height of input box. FIX THIS --> 
      <form class="navbar-form" role="search" id="search-form" style="padding: 1px 15px;"> 
       <div class="form-group"> 
        <input class="form-control" id="search-field" type="text" size="30" placeholder="Search"> 
       </div> 
      </form> 
     </div> 
    </div> 
   </div> 
  </nav> 
  <div class="container"> 
   <div class="row-fluid"> 
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9"> 
     <div id="search-panel"> 
      <div id="search-results"></div> 
      <div> 
       <br> 
       <a href="#" id="search-results-clear">clear</a> 
      </div> 
     </div> 
     <span class="pdf-link"><a href="ext-togglz.pdf"><img src="../../../images/PDF-50.png"></a></span> 
     <div class="page-title"> 
      <h1>Togglz Extension</h1> 
     </div> 
     <div id="doc-content">
      <div class="btn-group" style="float: right; font-size: small; padding: 6px;  ">
       <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/incodehq/incode-platform/edit/master/adocs/documentation/src/main/asciidoc/modules/ext/togglz/ext-togglz.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
       <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
       <ul class="dropdown-menu">
        <li><a href="https://github.com/incodehq/incode-platform/edit/master/adocs/documentation/src/main/asciidoc/modules/ext/togglz/ext-togglz.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
        <li><a href="https://github.com/incodehq/incode-platform/commits/master/adocs/documentation/src/main/asciidoc/modules/ext/togglz/ext-togglz.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
        <li><a href="https://github.com/incodehq/incode-platform/raw/master/adocs/documentation/src/main/asciidoc/modules/ext/togglz/ext-togglz.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
        <li><a href="https://github.com/incodehq/incode-platform/blame/master/adocs/documentation/src/main/asciidoc/modules/ext/togglz/ext-togglz.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
       </ul>
      </div> 
      <div id="preamble"> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This module (<code>isis-module-togglz</code>) provides an integration with <a href="http://www.togglz.org">Togglz</a> to provide a <a href="http://martinfowler.com/bliki/FeatureToggle.html">feature toggle</a> capability.</p> 
        </div> 
        <div class="paragraph"> 
         <p>Courtesy of Togglz, this integration has an embedded console and has support for integration testing through a custom JUnit rule.</p> 
        </div> 
        <div class="paragraph"> 
         <p>The module integrates both Togglz and uses the <a href="../../dom/settings/dom-settings.html">settings subdomain</a> for feature persistence.</p> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_screenshots">Screenshots</h2> 
       <div class="sectionbody"> 
        <div class="admonitionblock note"> 
         <table> 
          <tbody>
           <tr> 
            <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
            <td class="content"> 
             <div class="paragraph"> 
              <p>The screenshots below <strong>do</strong> demonstrate the functionality of this module, but are out of date in that they are taken from the original isisaddons/incodehq module (prior to being amalgamated into the incode-platform).</p> 
             </div> </td> 
           </tr> 
          </tbody>
         </table> 
        </div> 
        <div class="paragraph"> 
         <p>The following screenshots show an example app’s usage of the module.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_login_as_administrator">Login as administrator</h3> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/010-login-as-admin.png"><img src="images/010-login-as-admin.png" alt="010 login as admin" width="600px"></a> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_feature_disabled">Feature disabled</h3> 
         <div class="paragraph"> 
          <p>In the demo app the "Togglz Demo Objects" service has three actions, all of which are protected behind features. Two of these (for "create" and "listAll") are enabled by default, but one (for "findByName") is disabled by default, meaning that the action is suppressed from the UI:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/020-findByName-feature-disabled.png"><img src="images/020-findByName-feature-disabled.png" alt="020 findByName feature disabled" width="600px"></a> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_togglz_console">Togglz Console</h3> 
         <div class="paragraph"> 
          <p>Users with the appropriate role (<code>isis-module-togglz-admin</code>) can access the Togglz console, which lists all features:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/030-togglz-console-list-all.png"><img src="images/030-togglz-console-list-all.png" alt="030 togglz console list all" width="600px"></a> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Using the console, we can edit the feature:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/040-enable-feature.png"><img src="images/040-enable-feature.png" alt="040 enable feature" width="600px"></a> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>so it is now enabled:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/050-feature-enabled.png"><img src="images/050-feature-enabled.png" alt="050 feature enabled" width="600px"></a> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_feature_enabled">Feature enabled</h3> 
         <div class="paragraph"> 
          <p>Back in the demo app the feature ("findByName") is now visible:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/060-findByName-feature-enabled.png"><img src="images/060-findByName-feature-enabled.png" alt="060 findByName feature enabled" width="600px"></a> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_feature_persistence">Feature persistence</h3> 
         <div class="paragraph"> 
          <p>The module uses <a href="../../dom/settings/dom-settings.html">settings subdomain</a> module for feature persistence.</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/070-list-app-settings.png"><img src="images/070-list-app-settings.png" alt="070 list app settings" width="600px"></a> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Each feature’s state is serialized to/from JSON:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/080-setting-created-for-feature.png"><img src="images/080-setting-created-for-feature.png" alt="080 setting created for feature" width="600px"></a> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_service_spis">Service SPIs</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>The module defines the following SPI service that must be implemented:</p> 
        </div> 
        <div class="listingblock"> 
         <div class="content"> 
          <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">FeatureStateRepository</span> {
    FeatureState find(<span class="predefined-type">String</span> key);
    FeatureState create(<span class="predefined-type">String</span> key);
}</code></pre> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>where <code>FeatureState</code> is just a wrapper around a string:</p> 
        </div> 
        <div class="listingblock"> 
         <div class="content"> 
          <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">FeatureState</span> {
    <span class="predefined-type">String</span> getValue();
    <span class="type">void</span> setValue(<span class="predefined-type">String</span> value);
}</code></pre> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>This is used to persist the feature state.</p> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_how_to_configure_use">How to configure/use</h2> 
       <div class="sectionbody"> 
        <div class="sect2"> 
         <h3 id="_classpath">Classpath</h3> 
         <div class="paragraph"> 
          <p>Update the classpath in your project’s <code>dom</code> module <code>pom.xml</code> to reference the togglz library:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
    <span class="tag">&lt;togglz.version&gt;</span>2.1.0.Final<span class="tag">&lt;/togglz.version&gt;</span>
<span class="tag">&lt;/properties&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.togglz<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>togglz-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${togglz.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>+ * as described in the [Togglz documentation](<a href="http://www.togglz.org/documentation/overview.html" class="bare">http://www.togglz.org/documentation/overview.html</a>), create a "feature enum" class that enumerates your features. This should extend from <code>org.togglz.core.Feature</code>.<br></p> 
         </div> 
         <div class="paragraph"> 
          <p>+ For example, the demo app’s feature enum class is:<br></p> 
         </div> 
         <div class="paragraph"> 
          <p>+</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">enum</span> TogglzDemoFeature <span class="directive">implements</span> org.togglz.core.Feature {

    <span class="annotation">@Label</span>(<span class="string"><span class="delimiter">"</span><span class="content">Enable create</span><span class="delimiter">"</span></span>)
    <span class="annotation">@EnabledByDefault</span>
    create,

    <span class="annotation">@Label</span>(<span class="string"><span class="delimiter">"</span><span class="content">Enable findByName</span><span class="delimiter">"</span></span>)
    findByName,

    <span class="annotation">@Label</span>(<span class="string"><span class="delimiter">"</span><span class="content">Enable listAll</span><span class="delimiter">"</span></span>)
    <span class="annotation">@EnabledByDefault</span>
    listAll;

    <span class="directive">public</span> <span class="type">boolean</span> isActive() {
      <span class="keyword">return</span> FeatureContext.getFeatureManager().isActive(<span class="local-variable">this</span>);
    }
}</code></pre> 
          </div> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>use your feature class in your app as required.<br></p> 
            <div class="paragraph"> 
             <p>For example, the demo app uses its feature enum to selectively hide actions of the <code>TogglzDemoObjects</code> domain service:<br></p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">TogglzDemoObjects</span> {
    ...
    public <span class="predefined-type">List</span>&lt;TogglzDemoObject&gt; listAll() { ... }
    <span class="directive">public</span> <span class="type">boolean</span> hideListAll() {
      <span class="keyword">return</span> !TogglzDemoFeature.listAll.isActive();
    }
}</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>in your <code>integtests</code> module, update the <code>pom.xml</code> for togglz’s JUnit support:<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.togglz<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>togglz-junit<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre> 
             </div> 
            </div> </li> 
           <li> <p>also in your <code>integtests</code> module, make sure that the <code>TogglzRule</code> (documented <a href="http://www.togglz.org/documentation/testing.html">here</a> on the togglz website) is enabled for any tests that depend on features.<br></p> 
            <div class="paragraph"> 
             <p>In the demo app, this means adding the following to <code>TogglzModuleIntegTest</code> base class:<br></p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Rule</span>
<span class="directive">public</span> TogglzRule togglzRule = TogglzRule.allEnabled(TogglzDemoFeature.class);</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>update your classpath by adding this dependency in your project’s <code>fixture</code> module’s <code>pom.xml</code>:<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.isisaddons.module.togglz<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>isis-module-togglz-glue<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.16.1<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.isisaddons.module.security<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>isis-module-security-dom<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.16.1<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre> 
             </div> 
            </div> 
            <div class="colist arabic"> 
             <table> 
              <tbody>
               <tr> 
                <td><i class="conum" data-value="1"></i><b>1</b></td> 
                <td>or which ever is the latest version</td> 
               </tr> 
              </tbody>
             </table> 
            </div> </li> 
           <li> <p>in your project’s <code>app</code> module, write a subclass of <code>TogglzModuleFeatureManagerProviderAbstract</code> (provided by this module) that registers your feature enum:<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CustomTogglzModuleFeatureManagerProvider</span>
      <span class="directive">extends</span> TogglzModuleFeatureManagerProviderAbstract {
    <span class="directive">protected</span> CustomTogglzModuleFeatureManagerProvider() {
      <span class="local-variable">super</span>(TogglzDemoFeature.class);
    }
}</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>also in your project’s <code>app</code> module, in <code>src/main/resources</code>, register the provider by creating a file <code>META-INF/services/org.togglz.core.spi.FeatureManagerProvider</code>. Its contents is the fully qualified class name of your feature manager provider implementation.<br></p> 
            <div class="paragraph"> 
             <p>For example, the demo app’s file consists of:<br></p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code>org.isisaddons.module.togglz.webapp.CustomTogglzModuleFeatureManagerProvider</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>also in your project’s <code>app</code> module, write an implementation of the <code>FeatureStateRepository</code> SPI service (defined by this module). This SPI service is designed to be easy to be implemented using the <a href="../../dom/settings/dom-settings.html">settings subdomain</a> module (though you can of course use some other persistence mechanism if you wish). For example:<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">FeatureStateRepositoryForApplicationSettingsJdo</span> <span class="directive">implements</span> FeatureStateRepository {
    <span class="directive">public</span> FeatureState find(<span class="directive">final</span> <span class="predefined-type">String</span> key) {
        <span class="directive">final</span> ApplicationSetting applicationSetting =
                                      applicationSettingsService.find(key);
        <span class="keyword">return</span> FeatureStateForApplicationSettingJdo.from(applicationSetting);
    }
    <span class="directive">public</span> FeatureState create(<span class="directive">final</span> <span class="predefined-type">String</span> key) {
        <span class="directive">final</span> ApplicationSetting applicationSetting =
                                      applicationSettingsService.newString(key, <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>);
        <span class="keyword">return</span> FeatureStateForApplicationSettingJdo.from(applicationSetting);
    }
    <span class="annotation">@Inject</span>
    ApplicationSettingsServiceRW applicationSettingsService;
}</code></pre> 
             </div> 
            </div> 
            <div class="paragraph"> 
             <p>and:</p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">FeatureStateForApplicationSettingJdo</span> <span class="directive">implements</span> FeatureState {
    <span class="directive">static</span> FeatureState from(<span class="directive">final</span> ApplicationSetting applicationSetting) {
        <span class="keyword">return</span> applicationSetting != <span class="predefined-constant">null</span> ?
                    <span class="keyword">new</span> FeatureStateForApplicationSettingJdo(applicationSetting) : <span class="predefined-constant">null</span>;
    }
    <span class="directive">private</span> <span class="directive">final</span> ApplicationSettingForJdo applicationSetting;
    <span class="directive">private</span> FeatureStateForApplicationSettingJdo(<span class="directive">final</span> ApplicationSetting applicationSetting) {
        <span class="local-variable">this</span>.applicationSetting = (ApplicationSettingForJdo) applicationSetting;
    }
    <span class="directive">public</span> <span class="predefined-type">String</span> getValue() {
        <span class="keyword">return</span> applicationSetting.valueAsString();
    }
    <span class="directive">public</span> <span class="type">void</span> setValue(<span class="directive">final</span> <span class="predefined-type">String</span> value) {
        applicationSetting.updateAsString(value);
    }
}</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>in your <code>AppManifest</code>, update its <code>getModules()</code> method.<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Class</span>&lt;?&gt;&gt; getModules() {
    <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(
            ...
            org.isisaddons.module.security.SecurityModule.class,
            org.incode.example.settings.SettingsModule.class,
            org.isisaddons.module.togglz.TogglzModule.class,
            ...
    );
}</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>in your project’s <code>webapp</code> module, update your <code>WEB-INF/web.xml</code>, after the Shiro configuration but before Isis' configuration (so that the filters are applied in the order Shiro -&gt; Togglz -&gt; Isis):<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- bootstrap Togglz --&gt;</span>
<span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>org.togglz.FEATURE_MANAGER_PROVIDED<span class="tag">&lt;/param-name&gt;</span>
    <span class="comment">&lt;!-- prevent the filter from bootstrapping so is done lazily later once Isis has itself bootstrapped --&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>true<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>TogglzFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.togglz.servlet.TogglzFilter<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>TogglzFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
             </div> 
            </div> </li> 
           <li> <p>optional: if you want to install the Togglz console, then in your project’s <code>webapp</code> module, update your <code>WEB-INF/web.xml</code>:<br></p> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- enable the togglz console (for FeatureToggleService) --&gt;</span>
<span class="tag">&lt;servlet&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>TogglzConsoleServlet<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;servlet-class&gt;</span>org.togglz.console.TogglzConsoleServlet<span class="tag">&lt;/servlet-class&gt;</span>
<span class="tag">&lt;/servlet&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>TogglzConsoleServlet<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/togglz/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span></code></pre> 
             </div> 
            </div> 
            <div class="paragraph"> 
             <p>The togglz console will be available at <a href="http://localhost:8080/togglz">http://localhost:8080/togglz</a></p> 
            </div> </li> 
           <li> <p>if you have configured the Togglz console (above), then you’ll also need to setup users to have <code>isis-module-togglz-admin</code> role.<br></p> 
            <div class="paragraph"> 
             <p>The demo app uses simple Shiro-based configuration, which means updating the <code>WEB-INF/shiro.ini</code> file, eg:<br></p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="ini">sven = pass, admin_role, isis-module-togglz-admin</code></pre> 
             </div> 
            </div> </li> 
           <li> <p>if you have configured the Togglz console (above), then you can optionally configure its URL and also whether to hide the menu action provided to access the console from the main Wicket application:<br></p> 
            <div class="paragraph"> 
             <p>in <code>isis.properties</code> (or in <code>AppManifest#getConfigurationProperties()</code>):</p> 
            </div> 
            <div class="listingblock"> 
             <div class="content"> 
              <pre class="CodeRay highlight"><code data-lang="ini">isis.services.togglz.FeatureToggleConsoleAccessor.consoleUrl=http:///togglz     <i class="conum" data-value="1"></i><b>(1)</b>
isis.services.togglz.FeatureToggleConsoleAccessor.hideAction=false              <i class="conum" data-value="2"></i><b>(2)</b></code></pre> 
             </div> 
            </div> 
            <div class="colist arabic"> 
             <table> 
              <tbody>
               <tr> 
                <td><i class="conum" data-value="1"></i><b>1</b></td> 
                <td>URL that hosts the togglz console</td> 
               </tr> 
               <tr> 
                <td><i class="conum" data-value="2"></i><b>2</b></td> 
                <td>whether to hide the action that can be used to access the URL.</td> 
               </tr> 
              </tbody>
             </table> 
            </div> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>If you are using some other security mechanism, eg Isis addons <a href="../../spi/security/spi-security.html">security spi</a> module, then define a role with the same name and grant to users. You can use the <code>TogglzModuleAdminRole</code> to setup fixture/seed data for the security module.</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="ulist"> 
               <ul> 
                <li> <p>Check for later releases by searching <a href="http://search.maven.org/#search|ga|1|isis-module-togglz-glue">Maven Central Repo</a>).</p> </li> 
                <li> <p>Make sure the <code>togglz.version</code> defined in your <code>dom</code> module matches the one used in the version of the <code>isis-module-togglz-glue</code> module (currently <code>2.1.0.Final</code>).</p> </li> 
               </ul> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Check for later releases by searching [Maven Central Repo](<a href="http://search.maven.org/#search|ga|1|isis-module-togglz-glue" class="bare">http://search.maven.org/#search|ga|1|isis-module-togglz-glue</a>).</p> 
         </div> 
         <div class="paragraph"> 
          <p>For instructions on how to use the latest <code>-SNAPSHOT</code>, see the <a href="../../../pages/contributors-guide/contributors-guide.html">contributors guide</a>.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_known_issues">Known issues</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>None known at this time.</p> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_dependencies">Dependencies</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Maven can report modules dependencies using:</p> 
        </div> 
        <div class="listingblock"> 
         <div class="content"> 
          <pre class="CodeRay highlight"><code data-lang="bash">mvn dependency:list -o -pl modules/ext/togglz/impl -D excludeTransitive=true</code></pre> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>which, excluding Apache Isis itself, returns these compile/runtime dependencies:</p> 
        </div> 
        <div class="listingblock"> 
         <div class="content"> 
          <pre class="CodeRay highlight"><code data-lang="bash">com.google.code.gson:gson:jar:2.3.1:compile
org.apache.geronimo.specs:geronimo-servlet_3.0_spec:jar:1.0
org.togglz:togglz-servlet:jar:2.1.0.Final
org.togglz:togglz-console:jar:2.1.0.Final
org.togglz:togglz-core:jar:2.1.0.Final</code></pre> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>For further details on 3rd-party dependencies, see:</p> 
        </div> 
        <div class="ulist"> 
         <ul> 
          <li> <p><a href="http://www.togglz.org">Togglz</a></p> </li> 
         </ul> 
        </div> 
        <div class="paragraph"> 
         <p>The <a href="../../quickstart/quickstart.html">quickstart app</a> uses <a href="../../dom/settings/dom-settings.html">settings subdomain</a> module for feature persistence.</p> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="hidden-xs hidden-sm hidden-md col-lg-3"> 
     <nav id="toc" data-spy="affix" data-toggle="toc"></nav> 
    </div> 
   </div> 
  </div> 
  <footer class="footer"> 
   <div class="container"> 
    <div class="row"> 
     <p class="text-center small text-muted"> Copyright © 2012~date Dan Haywood, licensed under the Apache&nbsp;License,&nbsp;v2.0. </p> 
    </div> 
   </div> 
  </footer> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> 
  <script src="../../../js/bootstrap/3.3.7/bootstrap.min.js"></script> 
  <script src="../../../js/bootstrap-toc/0.4.1/bootstrap-toc.min.js"></script> 
  <script src="../../../js/slick/1.5.0/slick.min.js"></script> 
  <script src="../../../js/elasticlunr/elasticlunr.min.js"></script> 
  <script src="../../../js/sticky-header/sticky-header.js"></script> 
  <script src="../../../js/search-panel/search-panel.js"></script> 
  <script src="../../../js/header-link/header-link.js"></script> 
  <script src="../../../js/toc-scroll/toc-scroll.js"></script>  
 </body>
</html>
